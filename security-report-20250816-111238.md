# AirAccount Security Report
生成时间: 2025-08-16 11:12:38
项目版本: v0.3.0-webauthn-complete-2-g46312e0

## 执行摘要

### 依赖安全审计
⚠️ **发现以下安全问题:**
```
    │   ├── sqlx-macros-core 0.7.4
    │   └── sqlx 0.7.4
    ├── sqlx-macros-core 0.7.4
    ├── sqlx-macros 0.7.4
    └── sqlx 0.7.4

[0m[0m[1m[33mCrate:    [0m yaml-rust
[0m[0m[1m[33mVersion:  [0m 0.4.5
[0m[0m[1m[33mWarning:  [0m unmaintained
[0m[0m[1m[33mTitle:    [0m yaml-rust is unmaintained.
[0m[0m[1m[33mDate:     [0m 2024-03-20
[0m[0m[1m[33mID:       [0m RUSTSEC-2024-0320
[0m[0m[1m[33mURL:      [0m https://rustsec.org/advisories/RUSTSEC-2024-0320
[0m[0m[1m[33mDependency tree:
[0myaml-rust 0.4.5
└── config 0.13.4
    └── airaccount-ca-extended 0.1.0

[0m[0m[1m[31merror:[0m 2 vulnerabilities found!
[0m[0m[1m[33mwarning:[0m 3 allowed warnings found
```

### 依赖分析
- **总依赖数**: 112
- **构建依赖数**: 43
- **第三方模块数**:        3

### 代码安全检查
⚠️ **发现        5 个 unsafe 代码块:**
```rust
./target/aarch64-unknown-linux-gnu/release/build/ta-b2e23ed3d5297d09/out/user_ta_header.rs:pub unsafe extern "C" fn tahead_get_trace_level() -> c_int {
./target/aarch64-unknown-linux-gnu/release/build/ta-b2e23ed3d5297d09/out/user_ta_header.rs:    unsafe {
./target/aarch64-unknown-linux-gnu/debug/build/libsqlite3-sys-c69459715f1ef1de/out/bindgen.rs:            unsafe extern "C" fn(
./target/aarch64-unknown-linux-gnu/debug/build/libsqlite3-sys-c69459715f1ef1de/out/bindgen.rs:            unsafe extern "C" fn(
./target/aarch64-unknown-linux-gnu/debug/build/libsqlite3-sys-c69459715f1ef1de/out/bindgen.rs:    unsafe extern "C" fn(
```

### 构建脚本安全检查
⚠️ **发现       44 个构建脚本需要审查:**
- `./third_party/incubator-teaclave-trustzone-sdk/optee-utee/systest/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/optee-utee/optee-utee-sys/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/optee-teec/systest/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/optee-teec/optee-teec-sys/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/projects/web3/eth_wallet/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/tls_server-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/hello_world-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/secure_storage-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/supp_plugin-rs/plugin/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/supp_plugin-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/diffie_hellman-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/property-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/acipher-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/time-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/digest-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/tls_client-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/random-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/hotp-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/client_pool-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/big_int-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/aes-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/signature_verification-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/secure_db_abstraction-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/serde-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/build_with_optee_utee_sys-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/authentication-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/udp_socket-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/error_handling-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/tcp_client-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/mnist-rs/ta/train/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/mnist-rs/ta/inference/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/inter_ta-rs/ta/build.rs`
- `./third_party/incubator-teaclave-trustzone-sdk/examples/message_passing_interface-rs/ta/build.rs`
- `./packages/airaccount-ca-original-backup/airaccount-ca/build.rs`
- `./packages/airaccount-ca-original-backup/build.rs`
- `./packages/airaccount-ta-simple-original-backup/airaccount-ta-simple/build.rs`
- `./packages/airaccount-ta-simple-original-backup/build.rs`
- `./packages/airaccount-ca/build.rs`
- `./packages/airaccount-ta-simple/build.rs`
- `./packages/ta-arm-trustzone/build.rs`
- `./packages/airaccount-ta/build.rs`
- `./packages/ta-basic/build.rs`
- `./packages/airaccount-ta-original-backup/build.rs`
- `./packages/airaccount-ta-original-backup/airaccount-ta/build.rs`

### 许可证合规性
⚠️ cargo-license 未安装，跳过许可证检查

### 安全建议

#### 立即行动项
- [ ] 升级 SQLx 到 0.8.1+ 以修复 RUSTSEC-2024-0363
- [ ] 审查所有 unsafe 代码块的必要性
- [ ] 定期运行 `cargo audit` 检查新的安全漏洞

#### 长期改进项  
- [ ] 考虑替换不再维护的依赖包
- [ ] 建立依赖更新策略
- [ ] 配置 dependabot 自动检查更新

#### 监控项
- [ ] 定期审查构建脚本
- [ ] 监控 RSA 密钥操作的时序安全性
- [ ] 跟踪第三方模块的安全更新

### 总体风险评级
🔴 **高风险** (评分: 49/10)

---
*报告由 AirAccount 安全检查工具自动生成*  
*详细日志: /tmp/security-check-detailed.log*
